<template name="CreateReport">
	<div class="container" style="padding-top:50px;">
		<div class="col-xs-8 col-xs-offset-2 content-wrapper fill" style="margin-bottom:30px;">
			<div class="row" style="margin-bottom:30px;">
				<div class="col-xs-12" >
					{{#if currentRoute 'EditReport'}}
						{{> ReportForm id='report-form' doc=this type="update"}}
					{{else}}
						{{> ReportForm id='report-form' type="insert"}}
					{{/if}}
				</div>
			</div>
		</div>
	</div>
</template>

<template name="ReportForm">
	{{#autoForm collection="Reports" id=this.id type=this.type doc=this.doc style="margin: 0 20px;"}}
		<h2>Om prosjektet</h2>
		<fieldset>
		    <legend>Generelt</legend>
		    {{> afQuickField name='project.name' id="name" placeholder="schemaLabel"}}
		   	{{> afQuickField name='project.projectNumber' id="project-num" placeholder="schemaLabel"}}
		   	{{> afQuickField name='project.sector' id="sector" placeholder="schemaLabel"}}

			{{> RadioTrafficLight name="traffic-light" placeholder="Suksesskategori" curval=doc.project.successCategory}}
		</fieldset>
		<fieldset>
			<legend>Lokasjon</legend>
			<p>Velg ett sted med dobbel museklikk. Fjern sted med enkelt museklikk</p>
			{{>MapLocationPicker}}

			{{> afQuickField name='project.location.name' id="location" placeholder="schemaLabel"}}
		</fieldset>
		<fieldset>
			<legend>Prosjektbeskrivelse</legend>
			{{> afQuickField name='project.projectDescription.short' id="project-desc-short" placeholder="schemaLabel" rows="5"}}
			{{> afQuickField name='project.projectDescription.long' id="project-desc-long" placeholder="schemaLabel" rows="5"}}
		</fieldset>
		<fieldset>
			<legend>Tidsbeskrivelse</legend>
			{{> afQuickField name='project.decisionYear' id="decision-year" placeholder="schemaLabel"}}
			{{> afQuickField name='project.finishingYear' id="finishing-year" placeholder="schemaLabel"}}
			{{> afQuickField name='project.evaluationYear' id="eval-year" placeholder="schemaLabel"}}
		</fieldset>
		<fieldset>
			<legend>Økonomiske verdier</legend>
			{{> afQuickField name='project.managementBudget.amount' id="management-budget" placeholder="schemaLabel"}}
			{{> afQuickField name='project.costBudget.amount' id="cost-budget" placeholder="schemaLabel"}}
			{{> afQuickField name='project.costFinal.amount' id="cost-final" placeholder="schemaLabel"}}
		</fieldset>
		<fieldset>
			<legend>Ansvarlige</legend>
			{{> afQuickField name='responsible.organization' id="eval-responsible-org" placeholder="schemaLabel"}}
			{{> afQuickField name='responsible.person' id="eval-responsible-person" placeholder="schemaLabel"}}
			{{> afQuickField name='principal' id="principal" placeholder="schemaLabel"}}
		</fieldset>

		<h2>Evaluering</h2>
		<fieldset>
			<legend>Tekstlige vurderinger</legend>
			<h4>1. Produktivitet</h4>
			{{> afQuickField name='evaluation.productivity.short' id="eval-productivity-short" placeholder="schemaLabel" rows="5"}}
			{{> afQuickField name='evaluation.productivity.long' id="eval-productivity-long" placeholder="schemaLabel" rows="5"}}

			<h4>2. Måloppnåelse</h4>
			{{> afQuickField name='evaluation.achievement.short' id="eval-achievement-short" placeholder="schemaLabel" rows="5"}}
			{{> afQuickField name='evaluation.achievement.long' id="eval-achievement-long" placeholder="schemaLabel" rows="5"}}
			
			<h4>3. Virkninger</h4>
			{{> afQuickField name='evaluation.effects.short' id="eval-effects-short" placeholder="schemaLabel" rows="5"}}
			{{> afQuickField name='evaluation.effects.long' id="eval-effects-long" placeholder="schemaLabel" rows="5"}}

			<h4>4. Relevans</h4>
			{{> afQuickField name='evaluation.relevance.short' id="eval-relevance-short" placeholder="schemaLabel" rows="5"}}
			{{> afQuickField name='evaluation.relevance.long' id="eval-relevance-long" placeholder="schemaLabel" rows="5"}}

			<h4>5. Levedyktighet</h4>
			{{> afQuickField name='evaluation.viability.short' id="eval-viability-short" placeholder="schemaLabel" rows="5"}}
			{{> afQuickField name='evaluation.viability.long' id="eval-viability-long" placeholder="schemaLabel" rows="5"}}

			<h4>6. Samfunnsøkonomisk lønnsomhet</h4>
			{{> afQuickField name='evaluation.profitability.short' id="eval-profitability-short" placeholder="schemaLabel" rows="5"}}
			{{> afQuickField name='evaluation.profitability.long' id="eval-profitability-long" placeholder="schemaLabel" rows="5"}}
		</fieldset>
		<fieldset>
			<legend>Tallvurderinger</legend>
			{{> RadioGroupFive name="num-eval-productivity" placeholder="1. Produktivitet" curval=doc.evaluation.productivity.value}}
			{{> RadioGroupFive name="num-eval-achievement" placeholder="2. Måloppnåelse" curval=doc.evaluation.achievement.value}}
			{{> RadioGroupFive name="num-eval-effects" placeholder="3. Virkninger" curval=doc.evaluation.effects.value}}
			{{> RadioGroupFive name="num-eval-relevance" placeholder="4. Relevans" curval=doc.evaluation.relevance.value}}
			{{> RadioGroupFive name="num-eval-viability" placeholder="5. Levedyktighet" curval=doc.evaluation.viability.value}}
			{{> RadioGroupFive name="num-eval-profitability" placeholder="6. Samfunnsøkonomisk lønnsomhet" curval=doc.evaluation.profitability.value}}
		</fieldset>
		<fieldset>
			<legend>Referanser</legend>
			{{> Dropzone tp="files" typeDesc="filer" files=referencesList}}
		</fieldset>
		<fieldset>
			<legend>Illustrasjoner</legend>
			{{> Dropzone tp="images" typeDesc="bildefiler" files=imagesList}}
		</fieldset>
		<fieldset>
			<legend>Innstillinger</legend>
			{{> RadioDouble name="public-var" placeholder="Publisitet" curval=doc._public}}
		</fieldset>
						  
		{{#if currentRoute 'EditReport'}}
			<button type="submit" class="btn btn-primary pull-right">Lagre</button>
		{{else}}
			<button type="submit" class="btn btn-primary pull-right">Opprett</button>
		{{/if}}
		<button type="button" class="btn btn-default pull-right cancel-btn">Avbryt</button>
	{{/autoForm}}
	{{#if currentRoute 'EditReport'}}
		{{#afDeleteButton collection="Reports" doc=this.doc}}
		Slett
		{{/afDeleteButton}}
	{{/if}}
</template>

<template name="RadioDouble">
	<div class="control-group">
        <label label-default="" class="control-label">{{placeholder}}</label>
        <div class="controls">
			{{#if curval}}
				{{> RadioButton name=this.name value="1" text="Publiser" curval=curval}}
			{{else}}
				{{> RadioButton name=this.name value="1" text="Publiser" checked=1}}
			{{/if}}
			{{> RadioButton name=this.name value="0" text="Gjem" curval=curval}}
		</div>
    </div>
</template>

<template name="RadioTrafficLight">
	<div class="control-group">
        <label label-default="" class="control-label">{{placeholder}}</label>
        <div class="controls">
			{{#if curval}}
				{{> RadioButton name=this.name value="1" text="Rød" curval=curval}}
			{{else}}
				{{> RadioButton name=this.name value="1" text="Rød" checked=1}}
			{{/if}}
			{{> RadioButton name=this.name value="2" text="Gul" curval=curval}}
			{{> RadioButton name=this.name value="3" text="Grønn" curval=curval}}
		</div>
    </div>
</template>

<template name="RadioGroupFive">
	<div class="control-group">
        <label label-default="" class="control-label">{{placeholder}}</label>
        <div class="controls">
			{{#if curval}}
				{{> RadioButton name=this.name value="1" text="1" curval=curval}}
			{{else}}
				{{> RadioButton name=this.name value="1" text="1" checked=1}}
			{{/if}}
			{{> RadioButton name=this.name value="2" text="2" curval=curval}}
			{{> RadioButton name=this.name value="3" text="3" curval=curval}}
			{{> RadioButton name=this.name value="4" text="4" curval=curval}}
			{{> RadioButton name=this.name value="5" text="5" curval=curval}}
			{{> RadioButton name=this.name value="6" text="6" curval=curval}}
		</div>
	</div>
</template>

<template name="RadioButton">
	<label class="radio-inline">
		<input type="radio" name="{{name}}" id="{{name}}-option1" value="{{value}}" checked={{$checked curval value}}>
		{{text}}
	</label>
</template>

<template name="Dropzone">
	<div class="row">
		{{> DownloadListTable files=this.files type=this.tp}}
		<div class="col-xs-12">
		<div  class="dropzone text-center" id="dropzone-{{tp}}" style="text-aling:center;">
			
			<p style="padding:50px 10px;float:none;margin:auto;cursor:pointer;font-size:16px;"><b><i style="font-size:40px">Slipp {{typeDesc}} her</i></b><br>(eller klikk)</p>
			
			<input type="file" id="upload-{{tp}}" name="upload-{{tp}}" style="visibility: hidden; width: 1px; height: 1px" multiple />
		
		</div>
		</div>
	</div>
</template>

<template name="TextInput">
	<div class="form-group">
		<label for="{{id}}">{{placeholder}}</label>
		<input type="text" class="form-control" id="{{id}}" placeholder="{{placeholder}}" value="{{#if currentRoute 'EditReport'}}{{value}}{{/if}}">
	</div>
</template>

<template name="DownloadListTable">
	{{#if $isNotEmptyArray files}}
		<table class="table table-striped table-condensed voc_list ">
			<thead>
				<tr>
					<th style="width:15%;"></th>
					<th style="width:50%;"></th>
					<th style="width:30%;"></th>
					<th style="width:5%;"></th>
				</tr>
			</thead>
			<tbody>
				{{#each files}}
				<tr class="listview">
					<td class="text-center vert-align">
						{{#if $eq collectionName "images"}}
							{{#unless this.isUploaded}}
								<span class="glyphicon glyphicon-file" style="font-size:75px;"></span>
							{{else}}
								<img src="{{this.url store='original'}}" class="img-responsive" style="margin:auto;">
							{{/unless}}
						{{else}}
							<span class="glyphicon glyphicon-file" style="font-size:75px;"></span>
						{{/if}}
					</td>
					{{#with getData this._id parent=..}}
					<td class="vert-align">
						<h5>Navn: {{this.name}}</h5>
						{{#if $eq collectionName "images"}}
							{{> TextInput $generateId 'title' this._id placeholder="Tittel" value=title}}
							{{> TextInput $generateId 'copyright' this._id  placeholder="Kilde" value=copyright}}
							{{> TextInput $generateId 'link' this._id  placeholder="Kilde-url" value=link}}
						{{else}}
							{{> TextInput $generateId 'title' this._id  placeholder="Tittel" value=title}}
							{{> TextInput $generateId 'typedoc' this._id  placeholder="Type dokument" value=typedoc}}
							{{> TextInput $generateId 'date' this._id  placeholder="Dato" value=date}}
						{{/if}}
					</td>
					<td class="vert-align" style="padding-top:25px;">
						{{#unless this.isUploaded}}
							{{> FS.UploadProgressBar bootstrap=true}}
						{{else}}
							{{> FS.UploadProgressBar bootstrap=true class="progress-bar-success"}}
						{{/unless}}
					</td>
					<td class="text-center vert-align">
						{{#FS.DeleteButton type=type class="btn btn-danger btn-xs"}}Slett{{/FS.DeleteButton}}
					</td>
					{{/with}}
				</tr>
				{{/each}}
			</tbody>
		</table>
	{{/if}}
</template>

<template name="MapLocationPicker">
	<div class="content-wrapper" style="margin:30px 0;">
		<div id="map"></div>
	</div>
</template>

